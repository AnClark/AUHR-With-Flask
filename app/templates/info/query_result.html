{% extends 'info/base.html' %}

{% block content %}
    <!--    引入弹出窗口控制程序  -->
    <script src="{{ url_for('static', filename='js/popwindow.js') }}"></script>

    <script>
        function start_query(){
            //TODO: 后期考虑用AJAX实现结果页内的搜索
            var keyword = document.getElementById("keyword").value;
            location.href="/info/query_result?key=" + keyword;
        }

        function show_person_info_window(person_id){
            //document.getElementById("person-info").src = "/info/query_person?idx=" + person_id;
            show_popup_window();
        }
    </script>


    <!--  TODO:前置工具栏  -->
    <div class="query-header">
        <div class="query-header-column">
            <span style="font-size: 30px">关键字查询</span>
        </div>
        <div class="query-header-column">

            <div id="searchbar">
                <span>关键字：</span>
                <input type="text" id="keyword">
                <input type="button" id="start-query" value="查询" onclick="start_query()">
            </div>

        </div>
        <div class="query-header-clear"></div>
    </div>

    <div class="result-container">
        <!--    TODO:打印表头    -->
        <table id="result-table" class="result-table" border="1">
            <tr class="result-table-header">
                <th>姓名</th>
                <th>年级</th>
                <th>所在部门</th>
                <th>职务</th>
                <th>手机</th>
                <th>QQ</th>
            </tr>

            {% if result_assembly == False %}
                <tr class="result-not-found-error-line">
                    <td style="font-size: 60px" colspan="6">
                        未查询到关键字：{{ keyword }}
                    </td>
                </tr>

            {% else %}
                    {% for result in result_assembly %}
                            <tr id="{{ result['Name'] }}" class="result-table-line" onclick="show_person_info_window('{{ result['id'] }}')">
                                    <td id="result-Name">
                                        {{ result['Name'] }}
                                    </td>
                                    <td id="result-Grade">
                                        {{ result['Grade'] }}
                                    </td>
                                    <td id="result-Department">
                                        {{ result['Department'] }}
                                    </td>
                                    <td id="result-Occupation">
                                        {{ result['Occupation'] }}
                                    </td>
                                    <td id="result-Mobile">
                                        {{ result['Mobile'] }}
                                    </td>
                                    <td id="result-QQ">
                                        {{ result['QQ'] }}
                                    </td>
                            </tr>
                    {% endfor %}
            {% endif %}

        </table>



    </div>

    <!--    人员详细信息的弹出窗口 -->
    <div class="background-shade" id="shader" onclick="hide_popup_window()"></div>
    <div class="popup-window" id="popup-window">
        <div class="popup-window-title">
            <span>个人信息</span>
            <span class="close-button" onclick="hide_popup_window()">[关闭]</span>
        </div>
        <div class="popup-window-body">

            {% if isPremiumUser == True %}
                    <form id="modify-person-info" name="modify-person-info" action="" method="post">
                        <span>姓名</span>
                            <input type="text" name="Name" id="Name"> <br>
                        <span>性别</span>
                            <input type="radio" name="Gender" id="Gender-Male">男
                            <input type="radio" name="Gender" id="Gender-Female">女
                            <br>
                        <span>手机</span>
                            <input type="text" name="Mobile" id="Mobile"><br>
                        <span>QQ</span>
                            <input type="text" name="QQ" id="QQ"><br>
                        <span>生日</span>
                            <input type="date" name="Birthday" id="Birthday"><br>
                        <span>年级</span>
                            <input type="text" name="Grade" id="Grade"><br>
                        <span>院系</span>
                            <input type="text" name="Faculty" id="Faculty"><br>
                        <span>班级</span>
                            <input type="text" name="Class" id="Class"><br>
                        <span>寝室楼栋</span>
                            <input type="text" name="DormBuild" id="DormBuild"><br>
                        <span>所在社联部门</span>
                            <input type="text" name="Department" id="Department"><br>
                        <span>部门内分组</span>
                            <input type="text" name="GroupInDepart" id="GroupInDepart"><br>
                        <span>职务</span>
                            <input type="text" name="Occupation" id="Occupation"><br>
                        <span>社联编号</span>
                            <input type="text" name="AUID" id="AUID"><br>
                        <span>加入社联的时间</span>
                            <input type="date" name="ArrivalTime" id="ArrivalTime"><br>

                        <input type="submit" id="submit-form" value="提交更改">
                    </form>
            {% else %}
                        <div class="personinfo-container">
                                <div class="personinfo-line">
                                    <span>姓名</span>
                                    {{ result_assembly['Name'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>所在部门</span>
                                    {{ result_assembly['Department'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>部门内分组</span>
                                    {{ result_assembly['GroupInDepart'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>职务</span>
                                    {{ result_assembly['Occupation'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>性别</span>
                                    {{ result_assembly['Gender'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>手机号</span>
                                    {{ result_assembly['Mobile'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>QQ</span>
                                    {{ result_assembly['QQ'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>生日</span>
                                    {{ result_assembly['Birthday'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>年级</span>
                                    {{ result_assembly['Grade'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>专业</span>
                                    {{ result_assembly['Faculty'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>班级</span>
                                    {{ result_assembly['Class'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>寝室楼栋</span>
                                    {{ result_assembly['DormBuild'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>社联编号</span>
                                    {{ result_assembly['AUID'] }}
                                </div>
                                <div class="personinfo-line">
                                    <span>进入社联的时间</span>
                                    {{ result_assembly['ArrivalTime'] }}
                                </div>
                    </div>
            {% endif %}

        </div>
    </div>

{% endblock %}